<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link rel="stylesheet" href="style.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>

      let slides = document.getElementsByClassName("slide");
      let qtnArea = document.getElementsByClassName("Question-Area");
      let sumArea = document.getElementsByClassName("Summary-Area");
      let quizArea = document.getElementsByClassName("Quiz-Area");
      let submitBtn = document.getElementsByClassName("submit-button");
      let q1 = document.getElementsByName("Q1");
      let q2 = document.getElementsByName("Q2");
      let q3 = document.getElementsByName("Q3");
      let q4 = document.getElementsByName("Q4");
      let q5 = document.getElementsByName("Q5");
      let q6 = document.getElementsByName("Q6");
      let q7 = document.getElementsByName("Q7");
      let q8 = document.getElementsByName("Q8");
      let q9 = document.getElementsByName("Q9");
      let q10 = document.getElementsByName("Q10");
      let textAns = document.getElementsByClassName("codeInput");

      let textAnsArea = document.getElementsByClassName("Text-Answer-Area");
      let radioAnsArea = document.getElementsByClassName("Half-Answer-Area");

      let sumQtnDisplay = document.getElementsByClassName("sumQtnDisplay");
      let sumAnsDisplay = document.getElementsByClassName("sumAnsDisplay");

      const questionsGiven = [{
        "qtn": "write a sentence about your love for the c programming language.",
        "ans": "end my life",
        "type": 1
      },{
        "qtn": "<p>2. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "b",
        "type": 0
      },{
        "qtn": "Write the word test",
        "ans": "test",
        "type": 1
      },{
        "qtn": "<p>4. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "d",
        "type": 0
      },{
        "qtn": "<p>5. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "a",
        "type": 0
      },{
        "qtn": "<p>6. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "b",
        "type": 0
      },{
        "qtn": "<p>7. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "c",
        "type": 0
      },{
        "qtn": "<p>8. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "d",
        "type": 0
      },{
        "qtn": "<p>9. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "a",
        "type": 0
      },{
        "qtn": "<p>10. This is a question and below are the answers? <br> A) <br> B) <br> C) <br> D) </p>",
        "ans": "b",
        "type": 0
      }]
      let answers = [];
      const addAnswer = (question, answer) => {
        answers.push({"qtn":question, "ans":answer});
      }

      const submit = async (answers) => {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http://localhost/ben/quiz", true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        await xhr.send(JSON.stringify({
            answers
        }));

      }
      //console.log(submit(ans));

      let slideIndex = 1;
      showSlides(slideIndex);

      // Next/previous controls
      function plusSlides(n) {
        showSlides(slideIndex += n);
      }

      // Thumbnail image controls
      function currentSlide(n) {
        showSlides(slideIndex = n);
      }

      function showSlides(n) {
        let i;
        //let dots = document.getElementsByClassName("dot");
        if (n > slides.length) {
          slideIndex = 1;
        }
        if (n < 1) {
          slideIndex = slides.length;
        }
        if (n === slides.length) {
          submitBtn[0].style.display = "block";
        }
        else {
          submitBtn[0].style.display = "none";
        }
        for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
        }

        slides[slideIndex-1].style.display = "block";
        //dots[slideIndex-1].className += " active";
      }
      //function to populate questions from the JSON object
      function populateQuestions() {
        for(let i = 0; i < qtnArea.length; i++) {
          qtnArea[i].innerHTML = questionsGiven[i].qtn;

          if(questionsGiven[i].type === 0) {
            radioAnsArea[i*2].style.display = "block";
            radioAnsArea[(i*2)+1].style.display = "block";
            textAnsArea[i].style.display = "none";
          }
          else {
            radioAnsArea[i*2].style.display = "none";
            radioAnsArea[(i*2)+1].style.display = "none";
            textAnsArea[i].style.display = "block";
          }
        }
      }
      //function called when the submit button is pressed
      function submitPressed() {

        let numChecked = 0;
        let selections = ['a','b','c','d'];

        for(let i = 0; i < slides.length; i++) {
          if(questionsGiven[i].type === 0) {
            for(let k = 0; k < 4; k++) {
              if(eval(`q${i+1}`)[k].checked) {
                addAnswer(i+1,selections[k]);
                numChecked++;
              }
            }
          }
          else {
            if(textAns[i].value != "") {
              addAnswer(i+1,textAns[i].value);
              numChecked++;
            }
          }

        }
        if(numChecked == 10) {
          quizArea[0].style.display = "none";
          sumArea[0].style.display = "block";
          //test: to show answers submitted
          for(let i = 0; i < sumQtnDisplay.length; i++) {
            console.log(`${answers[i].qtn}) Your Ans: ${answers[i].ans}, Correct Ans: ${questionsGiven[i].ans}`);

            sumQtnDisplay[i].innerHTML = questionsGiven[i].qtn;
            sumAnsDisplay[i].innerHTML = `Your Answer: ${answers[i].ans} | Correct Answer: ${questionsGiven[i].ans}`
          }

        }
        else {
          console.log(`You only selected ${numChecked} out of 10 questions`);
        }

      }
    </script>
  </head>
  <body onload="populateQuestions()">
    <div>
      <nav class="bg-slate-100 shadow flex justify-between sticky top-0 z-50 place-items-center w-full">
        <div class="flex justify-center">
          <h1 class="mx-4">CITS3002 Project</h1>
          <button class="ml-4">logout</button>
          <a class="ml-4" href="profile.html">back</a>
        </div>
      </nav>
    </div>

    <div class="Summary-Area" style="flex: justify-center;
      width: 60%;
      height: 500px;
      margin: 100px 20% 0 20%;
      background: rgba(0,0,0,0.1);
      overflow: auto;">
      <h1>Marks Summary</h1><br>
      <div class="scoreDisplay">

      </div>
      <h2>Question 1:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 2:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 3:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 4:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 5:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 6:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 7:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 8:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 9:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
      <h2>Question 10:</h2>
      <div class="sumQtnDisplay">

      </div>
      <div class="sumAnsDisplay">

      </div>
    </div>

  </body>
</html>
